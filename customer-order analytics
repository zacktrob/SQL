#In this SQL, I'm querying a database with multiple tables in it to quantify statistics about customer and order data. 

--How many orders were placed in January?
select distinct count(orderID) from bit_db.jansales;

--HOw many of those order were for an iPhone?
select count(*)
from bit_db.JanSales
where product = 'iPhone';

--Select the customer account numbers for all the orders that were placed in Feb
select bit_db.customers.acctnum
from bit_db.customers
join bit_db.FebSales
on bit_db.customers.order_id = bit_db.febsales.orderID;


--Which product was the cheapest one sold in Jan, price?
select bit_db.jansales.price, product
from bit_db.jansales
group by product
order by price
limit 1;

--What is total revenue for each product sold in Jan? 
select product, round(sum(price) * quantity, 2) as revenue
from bit_db.JanSales
group by product
order by price; 


--Which products were sold in Feb at 548 Lincoln St, Seattle, WA 98101? How many of each were sold, total revenue?
select product, quantity, round(sum(price) * quantity, 2) as revenue
from bit_db.febsales
where location = '548 Lincoln St, Seattle, WA 98101'; 


--How many customers ordered more than 2 products at a time in Feb, avg amount spent?
select count(customers.acctnum), avg(quantity*price)
from customers
join febsales
on customers.order_id = febsales.orderID
where febsales.Quantity > 2; 

--List all the products sold in Los Angeles in February, and include how many of each were sold
select product, sum(quantity) as total_sold
from bit_db.febsales
where location like '%Los Angeles%'
group by product
order by total_sold; 

--Which locations in New York received at least 3 orders in January, and how many orders did they each receive? 
select location, count(orderdate)
from jansales
where location like '%New York%'
group by location
having count(orderdate) > 2; 

--How many of each type of headphone were sold in February?
select product, sum(quantity) 
from febsales
where product like '%headphones%'
group by product;


--What was the average amount spent per account in February? 
select avg(quantity * price) as Average_amount
from bit_db.febsales feb
left join bit_db.customers cust
on feb.orderid = cust.order_id; 

--what was the avg quantity of products purchased per account in Feb?
select avg(feb.quantity)
from bit_db.febsales feb
join bit_db.customers cust
on feb.orderid = cust.order_id; 

--which product brought in the most revenue in January and how much revenue did it bring in total? 
select product, sum(quantity) as Total_units_Sold, round(sum(price), 2) as Total_Revenue
from bit_db.JanSales
group by product
order by Total_Revenue desc; 



